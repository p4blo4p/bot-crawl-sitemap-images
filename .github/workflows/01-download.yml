      - name: Prepare Data Branch
        run: |
          git config --global user.name "Sitemap Bot"
          git config --global user.email "bot@actionforge.local"
          # Optimize Git for large pushes (HTTP/1.1 is more stable for large payloads)
          git config --global http.postBuffer 1048576000
          git config --global http.version HTTP/1.1
          git config --global core.compression 9
          # Network resilience
          git config --global http.lowSpeedLimit 0
          git config --global http.lowSpeedTime 999999
          git config --global pack.windowMemory 100m
          
          REPO_URL="https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }}.git"
          
          # Try to clone the branch. If it fails (branch doesn't exist or is empty), initialize it.
          if git clone --depth 1 --single-branch --branch ${{ env.SITEMAP_BRANCH }} "$REPO_URL" sitemaps_data; then
            echo "Branch cloned successfully."
          else
            echo "Branch not found or is empty. Initializing..."
            mkdir sitemaps_data
            cd sitemaps_data
            git init
            git checkout -b ${{ env.SITEMAP_BRANCH }}
            git remote add origin "$REPO_URL"
            echo '{"created": true}' > global_state.json
            git add .
            git commit -m "Initial data structure"
            cd ..
          fi
